# Домашнее задание к занятию 12.3 "Реляционные базы данных: SQL. Часть 1"

Домашнее задание нужно выполнить на Dataset из презентации.

*Решение нужно прислать одним SQL файлом, содержащим запросы по всем заданиям.*

Любые вопросы по решению задач задавайте в чате учебной группы.


---

Задание можно выполнить как в любом IDE, так и в командной строке.

### Задание 1.

Получите уникальные названия районов из таблицы с адресами, которые начинаются на “K” и заканчиваются на “a”, и не содержат пробелов.

```
SELECT DISTINCT city_id, city
From city
WHERE city Like 'K%a';
```

```
city_id|city        |
-------+------------+
    252|Kaduna      |
    253|Kakamigahara|
    256|Kamakura    |
    260|Kanazawa    |
    261|Kanchrapara |
    276|Koriyama    |
    277|Korla       |
    281|Ktahya      |
    287|Kuwana      |
```


### Задание 2.

Получите из таблицы платежей за прокат фильмов информацию по платежам, которые выполнялись в промежуток с 15 июня 2005 года по 18 июня 2005 года **включительно**, 
и стоимость которых превышает 10.00.

```
По числам:

SELECT * from rental
WHERE rental_date BETWEEN '2005-06-15' and '2005-06-18';

Больше > 10 

SELECT * from payment
WHERE payment_date  BETWEEN '2005-06-15' and '2005-06-18' and amount > 10;
```

```
payment_id|customer_id|staff_id|rental_id|amount|payment_date       |last_update        |
----------+-----------+--------+---------+------+-------------------+-------------------+
       908|         33|       1|     1301| 10.99|2005-06-15 09:46:33|2006-02-15 22:12:36|
      7017|        260|       1|     2091| 10.99|2005-06-17 18:09:04|2006-02-15 22:14:58|
      8272|        305|       1|     2166| 11.99|2005-06-17 23:51:21|2006-02-15 22:15:47|
     13892|        516|       1|     1718| 10.99|2005-06-16 14:52:02|2006-02-15 22:20:47|
     14620|        544|       2|     1434| 10.99|2005-06-15 18:30:46|2006-02-15 22:21:35|
     15313|        572|       2|     1889| 10.99|2005-06-17 04:05:12|2006-02-15 22:22:22|
```

### Задание 3.

Получите последние 5 аренд фильмов.

```
SELECT rental_rate, title
from film
ORDER BY rental_rate DESC, title
Limit 5;
```
```
rental_rate|title           |
-----------+----------------+
       4.99|ACE GOLDFINGER  |
       4.99|AIRPLANE SIERRA |
       4.99|AIRPORT POLLOCK |
       4.99|ALADDIN CALENDAR|
       4.99|ALI FOREVER     |
```

### Задание 4.

Одним запросом получите активных покупателей, имена которых Kelly или Willie. 

Сформируйте вывод в результат таким образом:
- все буквы в фамилии и имени из верхнего регистра переведите в нижний регистр,
- замените буквы 'll' в именах на 'pp'

```
SELECT (LOWER(first_name)),(LOWER(last_name)), email,
REPLACE (first_name, 'LL', 'PP')
from customer
WHERE first_name Like 'kel%' OR first_name = 'willie'
```
```
(LOWER(first_name))|(LOWER(last_name))|email                            |REPLACE (first_name, 'LL', 'PP')|
-------------------+------------------+---------------------------------+--------------------------------+
kelly              |torres            |KELLY.TORRES@sakilacustomer.org  |KEPPY                           |
willie             |howell            |WILLIE.HOWELL@sakilacustomer.org |WIPPIE                          |
willie             |markham           |WILLIE.MARKHAM@sakilacustomer.org|WIPPIE                          |
kelly              |knott             |KELLY.KNOTT@sakilacustomer.org   |KEPPY                           |

```
## Дополнительные задания (со звездочкой*)
Эти задания дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.

### Задание 5*.

Выведите Email каждого покупателя, разделив значение Email на 2 отдельных колонки: в первой колонке должно быть значение, указанное до @, во второй значение, указанное после @.

### Задание 6.*

Доработайте запрос из предыдущего задания, скорректируйте значения в новых колонках: первая буква должна быть заглавной, остальные строчными.